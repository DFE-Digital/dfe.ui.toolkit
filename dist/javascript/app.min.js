"use strict";function sortTable(t){var a,e,n,o,i,r,s,d,l=0;for(a=$("table.sortable"),n=!0,d="a";n;){for(n=!1,e=a.find("tr"),o=1;o<e.length-1;o++)if(s=!1,i=e[o].getElementsByTagName("TD")[t],r=e[o+1].getElementsByTagName("TD")[t],"a"===d){if(i.innerHTML.toLowerCase()>r.innerHTML.toLowerCase()){s=!0;break}}else if("d"===d&&i.innerHTML.toLowerCase()<r.innerHTML.toLowerCase()){s=!0;break}s?(e[o].parentNode.insertBefore(e[o+1],e[o]),n=!0,l++):0===l&&"a"===d&&(d="d",n=!0)}return d}(NSA=NSA||{}).modal={elems:{links:$(".modal-link"),modals:$(".modal")},init:function(){this.modalBg(),this.setUpEvents()},modalBg:function(){var t=this,a=$("<div>").addClass("modal-bg").hide().on("click",function(){t.hideModals()});$("body").append(a)},setUpEvents:function(){var t=this;this.elems.links.on("click",function(a){var e=$(this).attr("href");t.showModal($(e)),a.preventDefault()}),t.elems.modals.find(".close").on("click",function(a){t.hideModals(),a.preventDefault()}),$("body").on("keydown",function(a){27===(a.keyCode||a.which)&&t.hideModals()})},showModal:function(t){$("html").addClass("modal-open"),$(".modal-bg").show(),t.show()},hideModals:function(){$("html").removeClass("modal-open"),$(".modal-bg").hide(),this.elems.modals.hide()}},NSA.modal.init(),function(t){function a(){function t(){var t=e(this),n=a(t);n.length&&(t.attr("aria-controls",n.attr("id")),t.attr("aria-expanded","false"),n.attr("aria-hidden","true"))}function a(t){var a=t.attr("aria-controls");return a||(a=t.closest("[data-target]").data("target")),e("#"+a)}function n(t,a){a.hasClass("js-hidden")&&(a.removeClass("js-hidden"),a.attr("aria-hidden","false"),t.attr("aria-controls")&&t.attr("aria-expanded","true"))}function o(t,e){(e=e||a(t)).hasClass("js-hidden")||(e.addClass("js-hidden"),e.attr("aria-hidden","true"),t.attr("aria-controls")&&t.attr("aria-expanded","false"))}function i(t,a){var i=d.radio+"[name="+function(t){return t.replace("[","\\[").replace("]","\\]")}(t.attr("name"))+"][aria-controls]",r=t.closest("form");(r.length?r.find(i):e(i)).each(function(){o(e(this))}),t.is("[aria-controls]")&&n(t,a)}function r(t,a){t.is(":checked")?n(t,a):o(t,a)}function s(n,o,i,r){function s(){var t=e(this);r(t,a(t))}n=n||e(document.body);var l=e(o);l.each(t),e.each(i,function(t,a){n.on("click."+d.namespace,a,s)}),l.is(":checked")&&l.filter(":checked").each(s)}var d={namespace:"ShowHideContent",radio:'[data-target] > input[type="radio"]',checkbox:'[data-target] > input[type="checkbox"]'};this.showHideRadioToggledContent=function(t){s(t,d.radio,function(){var t=[];return e(d.radio).map(function(){var a=e(this).attr("name");return-1===e.inArray(a,t)?(t.push(a),'input[type="radio"][name="'+e(this).attr("name")+'"]'):null})}(),i)},this.showHideCheckboxToggledContent=function(t){s(t,d.checkbox,[d.checkbox],r)},this.destroy=function(t){(t=t||e(document.body)).off("."+d.namespace)}}var e=t.jQuery,n=t.GOVUK||{};a.prototype.init=function(t){this.showHideRadioToggledContent(t),this.showHideCheckboxToggledContent(t)},n.ShowHideContent=a,t.GOVUK=n}(window);(NSA=NSA||{}).signin={form:$(".form-signin"),init:function(){this.setupEvents()},setupEvents:function(){this.form.on("submit",this,this.handleSubmit)},handleSubmit:function(t){var a=$(this),e=a.find("input").not(":checkbox"),n={},o=$(this).find("button:submit").eq(0);o.css("min-width",o.outerWidth()+"px"),o.find(".loader").removeClass("vh"),e.each(function(){n[this.name]=$(this).val()}),$("#password").prop("type","password").next().removeClass("type-password"),$.ajax({type:"POST",data:n,url:a.attr("action"),context:t.data,dataType:"json",success:function(t){t.isFailedLogin?(this.resetValidation(a),this.showValidationMessage(t.validationMessages),this.showInlineValidation(t.validationMessages),o.find(".loader").addClass("vh")):this.buildFormAndSubmit(t)},statusCode:{403:function(){o.find(".loader").addClass("vh")},500:function(){o.find(".loader").addClass("vh")}}}),t.preventDefault()},resetValidation:function(t){var a=t.find(".form-group");$(".error-summary").remove(),a.each(function(){var t=$(this).find("input").eq(0);$(this).hasClass("form-group-error")&&($(this).removeClass("form-group-error"),$(this).find("p.error-message").remove(),t.removeAttr("aria-describedby").removeAttr("aria-invalid"))})},showValidationMessage:function(t){var a=$("<div />").attr("class","error-summary").attr("role","alert").attr("tabindex","-1"),e=$("<h2 />").attr("class","heading-medium error-summary-heading").attr("id","error-summary").text("Information missing or incorrect"),n=$("<ul />").attr("class","error-summary-list");$.each(t,function(t,a){var e=$("<a />").attr("href","#"+t).text(a),o=$("<li />").attr("class","").append(e);n.append(o)}),a.append(e).append(n),$("main").prepend(a),$("html, body").animate({scrollTop:a.offset().top-15},300)},showInlineValidation:function(t){$.each(t,function(t,a){var e=$("input[name="+t+"]"),n=e.parent();n.hasClass("show-password")&&(n=n.parent());var o=n.find("label").first();if(!n.hasClass("form-group-error"))var i=$("<p>").html(a).prop("class","error-message").prop("id","validation-"+t);o.after(i),n.addClass("form-group-error"),e.attr({"aria-describedby":"validation-"+t,"aria-invalid":"true"})})},buildFormAndSubmit:function(t){var a=$("<form />").attr({method:"post",action:t.destination});$.each(t.postbackData,function(t,e){var n=$("<input />").attr({type:"hidden",name:t,value:e});a.append(n)}),$("body").append(a),a.submit()}},$(".form-signin").length>0&&NSA.signin.init(),$(function(){$("table.sortable thead th").on("click",function(){var t=$("table.sortable thead tr th");t.removeClass("sorted").removeClass("dir-a").removeClass("dir-d");var a=sortTable(t.index($(this)));$(this).addClass("sorted dir-"+a)})});var toggleTips=$(".toggle-help");toggleTips.each(function(){var t,a,e,n;t=$(this),e=$("<span />").attr("class","toggletip"),n=$("<button />").attr("type","button").attr("aria-label","Help").attr("data-toggletip-content",t.html()).text("?").on("click",function(){var a=$(this).data("toggletip-content"),e=$(this).next();window.setTimeout(function(){e.html(function(){return $("<span />").attr("class",function(){return t.html().length>50?"bubble long":"bubble"}).text(a)})},100)}).on("keydown",function(t){27===(t.keyCode||t.which)&&a.html("")}),a=$("<span />").attr("role","status"),e.append(n,a),t.before(e).remove(),$(document).on("click",function(e){t[0]!==$(e.target)&&a.html("")})});var forms=$("#content form");forms.attr("novalidate","novalidate");var NSA=NSA||{};NSA={showPassword:function(){$(".show-password").each(function(t){var a=$(this).find("input:password"),e=$("<label />").prop({for:"show-password-"+t}).html("Show"),n=$("<input />").prop({type:"checkbox",id:"show-password-"+t}).on("change",function(){var t=$(this);a.prop("type",function(){return t.prop("checked")?"text":"password"}),e.html(function(){return t.prop("checked")?"Hide":"Show"}),t.parent().removeClass("type-password"),t.prop("checked")&&t.parent().addClass("type-password")}),o=$("<div />").prop("class","show-password-control").append(n,e);a.after(o)})},backLink:function(){var t=$("<a>").attr({href:"#",class:"link-back"}).text("Back").on("click",function(t){window.history.back(),t.preventDefault()});$(".js-back-link").html(t)}},$("select.select2").length>0&&$("select.select2").select2(),$(".show-password").length>0&&NSA.showPassword(),$(".js-back-link")&&NSA.backLink(),$(".under-construction").on("click",function(t){alert("This functionality is not available yet"),t.preventDefault()}),$(".notification span.icon").length>0&&$(".notification span.icon").on("click",function(){$(this).parent().hide()});var showHideContent=new GOVUK.ShowHideContent;showHideContent.init();