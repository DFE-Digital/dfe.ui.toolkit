function sortTable(t){var e,a,n,i,r,o,s,d,l=0;for(e=$("table.sortable"),n=!0,d="a";n;){for(n=!1,a=e.find("tr"),i=1;i<a.length-1;i++)if(s=!1,r=a[i].getElementsByTagName("TD")[t],o=a[i+1].getElementsByTagName("TD")[t],"a"===d){if(r.innerHTML.toLowerCase()>o.innerHTML.toLowerCase()){s=!0;break}}else if("d"===d&&r.innerHTML.toLowerCase()<o.innerHTML.toLowerCase()){s=!0;break}s?(a[i].parentNode.insertBefore(a[i+1],a[i]),n=!0,l++):0===l&&"a"===d&&(d="d",n=!0)}return d}!function(t){"use strict";var e=t.GOVUK||{};e.details={NATIVE_DETAILS:"boolean"==typeof document.createElement("details").open,KEY_ENTER:13,KEY_SPACE:32,started:!1,addEvent:function(t,e,a){t.addEventListener?t.addEventListener(e,function(t){a(t,t.target)},!1):t.attachEvent&&t.attachEvent("on"+e,function(t){a(t,t.srcElement)})},removeEvent:function(t,e){t.removeEventListener?t.removeEventListener(e,function(t){},!1):t.detachEvent&&t.detachEvent("on"+e,function(t){})},charCode:function(t){return"number"==typeof t.which?t.which:t.keyCode},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},addClickEvent:function(t,a){e.details.addEvent(t,"keypress",function(t,n){e.details.charCode(t)!==e.details.KEY_ENTER&&e.details.charCode(t)!==e.details.KEY_SPACE||"summary"===n.nodeName.toLowerCase()&&(e.details.preventDefault(t),n.click?n.click():a(t,n))}),e.details.addEvent(t,"keyup",function(t,a){e.details.charCode(t)===e.details.KEY_SPACE&&"SUMMARY"===a.nodeName&&e.details.preventDefault(t)}),e.details.addEvent(t,"click",function(t,e){a(t,e)})},getAncestor:function(t,e){do{if(!t||t.nodeName.toLowerCase()===e)break;t=t.parentNode}while(t);return t},addDetailsPolyfill:function(t,a){if(a=a||document.body,!e.details.started&&(e.details.started=!0,0!==(t=a.getElementsByTagName("details")).length)){var n=t.length,i=0;for(i;i<n;i++){var r=t[i];if(r.__summary=r.getElementsByTagName("summary").item(0),r.__content=r.getElementsByTagName("div").item(0),!r.__summary||!r.__content)return;r.__content.id||(r.__content.id="details-content-"+i),r.setAttribute("role","group"),r.__summary.setAttribute("role","button"),r.__summary.setAttribute("aria-controls",r.__content.id),e.details.NATIVE_DETAILS||(r.__summary.tabIndex=0);var o=null!==r.getAttribute("open");if(!0===o?(r.__summary.setAttribute("aria-expanded","true"),r.__content.setAttribute("aria-hidden","false")):(r.__summary.setAttribute("aria-expanded","false"),r.__content.setAttribute("aria-hidden","true"),e.details.NATIVE_DETAILS||(r.__content.style.display="none")),r.__summary.__details=r,!e.details.NATIVE_DETAILS){var s=document.createElement("i");!0===o?(s.className="arrow arrow-open",s.appendChild(document.createTextNode("▼"))):(s.className="arrow arrow-closed",s.appendChild(document.createTextNode("►"))),r.__summary.__twisty=r.__summary.insertBefore(s,r.__summary.firstChild),r.__summary.__twisty.setAttribute("aria-hidden","true")}}e.details.addClickEvent(a,function(t,a){return!(a=e.details.getAncestor(a,"summary"))||e.details.statechange(a)})}},statechange:function(t){var a="true"===t.__details.__summary.getAttribute("aria-expanded"),n="true"===t.__details.__content.getAttribute("aria-hidden");if(t.__details.__summary.setAttribute("aria-expanded",a?"false":"true"),t.__details.__content.setAttribute("aria-hidden",n?"false":"true"),!e.details.NATIVE_DETAILS){t.__details.__content.style.display=a?"none":"";null!==t.__details.getAttribute("open")?t.__details.removeAttribute("open"):t.__details.setAttribute("open","open")}return t.__twisty&&(t.__twisty.firstChild.nodeValue=a?"►":"▼",t.__twisty.setAttribute("class",a?"arrow arrow-closed":"arrow arrow-open")),!0},destroy:function(t){e.details.removeEvent(t,"click")},init:function(t){e.details.addEvent(document,"DOMContentLoaded",e.details.addDetailsPolyfill),e.details.addEvent(window,"load",e.details.addDetailsPolyfill)}},t.GOVUK=e}(window);(NSA=NSA||{}).modal={elems:{links:$(".modal-link"),modals:$(".modal")},init:function(){this.modalBg(),this.setUpEvents()},modalBg:function(){var t=this,e=$("<div>").addClass("modal-bg").hide().on("click",function(){t.hideModals()});$("body").append(e)},setUpEvents:function(){var t=this;this.elems.links.on("click",function(e){var a=$(this).attr("href");t.showModal($(a)),e.preventDefault()}),t.elems.modals.find(".close").on("click",function(e){t.hideModals(),e.preventDefault()}),$("body").on("keydown",function(e){27===(e.keyCode||e.which)&&t.hideModals()})},showModal:function(t){$("html").addClass("modal-open"),$(".modal-bg").show(),t.show()},hideModals:function(){$("html").removeClass("modal-open"),$(".modal-bg").hide(),this.elems.modals.hide()}},NSA.modal.init(),function(t){"use strict";function e(){function t(){var t=a(this),n=e(t);n.length&&(t.attr("aria-controls",n.attr("id")),t.attr("aria-expanded","false"),n.attr("aria-hidden","true"))}function e(t){var e=t.attr("aria-controls");return e||(e=t.closest("[data-target]").data("target")),a("#"+e)}function n(t,e){e.hasClass("js-hidden")&&(e.removeClass("js-hidden"),e.attr("aria-hidden","false"),t.attr("aria-controls")&&t.attr("aria-expanded","true"))}function i(t,a){(a=a||e(t)).hasClass("js-hidden")||(a.addClass("js-hidden"),a.attr("aria-hidden","true"),t.attr("aria-controls")&&t.attr("aria-expanded","false"))}function r(t,e){var r=d.radio+"[name="+function(t){return t.replace("[","\\[").replace("]","\\]")}(t.attr("name"))+"][aria-controls]",o=t.closest("form");(o.length?o.find(r):a(r)).each(function(){i(a(this))}),t.is("[aria-controls]")&&n(t,e)}function o(t,e){t.is(":checked")?n(t,e):i(t,e)}function s(n,i,r,o){function s(){var t=a(this);o(t,e(t))}n=n||a(document.body);var l=a(i);l.each(t),a.each(r,function(t,e){n.on("click."+d.namespace,e,s)}),l.is(":checked")&&l.filter(":checked").each(s)}var d={namespace:"ShowHideContent",radio:'[data-target] > input[type="radio"]',checkbox:'[data-target] > input[type="checkbox"]'};this.showHideRadioToggledContent=function(t){s(t,d.radio,function(){var t=[];return a(d.radio).map(function(){var e=a(this).attr("name");return-1===a.inArray(e,t)?(t.push(e),'input[type="radio"][name="'+a(this).attr("name")+'"]'):null})}(),r)},this.showHideCheckboxToggledContent=function(t){s(t,d.checkbox,[d.checkbox],o)},this.destroy=function(t){(t=t||a(document.body)).off("."+d.namespace)}}var a=t.jQuery,n=t.GOVUK||{};e.prototype.init=function(t){this.showHideRadioToggledContent(t),this.showHideCheckboxToggledContent(t)},n.ShowHideContent=e,t.GOVUK=n}(window);(NSA=NSA||{}).signin={form:$(".form-signin"),init:function(){this.setupEvents()},setupEvents:function(){this.form.on("submit",this,this.handleSubmit)},handleSubmit:function(t){var e=$(this),a=e.find("input").not(":checkbox"),n={},i=$(this).find("button:submit"),r=i.eq(0);i.attr("disabled","disabled"),r.css("min-width",r.outerWidth()+"px"),r.find(".loader").removeClass("vh"),a.each(function(){n[this.name]=$(this).val()}),$("#password").prop("type","password").next().removeClass("type-password"),$.ajax({type:"POST",data:n,url:e.attr("action"),context:t.data,dataType:"json",success:function(t){t.redirect?window.location.href=t.uri:t.isFailedLogin?(this.resetValidation(e),this.showValidationMessage(t.validationMessages),this.showInlineValidation(t.validationMessages),i.removeAttr("disabled"),r.find(".loader").addClass("vh")):(gtag("event","Successful login",{event_category:"Login",event_label:"User logged in"}),this.buildFormAndSubmit(t))},error:function(){this.resetValidation(e),this.showValidationMessage(),i.removeAttr("disabled"),r.find(".loader").addClass("vh")}}),t.preventDefault()},resetValidation:function(t){var e=t.find(".form-group");$(".error-summary").remove(),e.each(function(){var t=$(this).find("input").eq(0);$(this).hasClass("form-group-error")&&($(this).removeClass("form-group-error"),$(this).find("p.error-message").remove(),t.removeAttr("aria-describedby").removeAttr("aria-invalid"))})},showValidationMessage:function(t){var e=$("<div />").attr("class","error-summary").attr("role","alert").attr("tabindex","-1"),a=$("<h2 />").attr("class","heading-medium error-summary-heading").attr("id","error-summary"),n=$("<ul />").attr("class","error-summary-list");if(t)a.text("Information missing or incorrect"),$.each(t,function(t,e){"loginError"===t&&(t="username",gtag("event","Failed login",{event_category:"Login",event_label:"Users login credentials were wrong"}));var a=$("<a />").attr("href","#"+t).text(e),i=$("<li />").append(a);n.append(i)});else{a.text("There has been an error");var i=$("<li />").html('Please try again later. If the problem continues, follow the link to <a href="https://help.signin.education.gov.uk/contact">submit a support request</a>');n.append(i),gtag("event","Error occurred",{event_category:"Login",event_label:"A server error occurred during login"})}e.append(a).append(n),$("main").prepend(e),$("html, body").animate({scrollTop:e.offset().top-15},300)},showInlineValidation:function(t){$.each(t,function(t,e){var a=$("input[name="+t+"]"),n=a.parent();n.hasClass("show-password")&&(n=n.parent());var i=n.find("label").first();if(!n.hasClass("form-group-error"))var r=$("<p>").html(e).prop("class","error-message").prop("id","validation-"+t);i.after(r),n.addClass("form-group-error"),a.attr({"aria-describedby":"validation-"+t,"aria-invalid":"true"})})},buildFormAndSubmit:function(t){var e=$("<form />").attr({method:"post",action:t.destination,id:"dfesigninform"});$.each(t.postbackData,function(t,a){var n=$("<input />").attr({type:"hidden",name:t,value:a});e.append(n)}),$("#dfesigninform").remove(),$("body").append(e),e.submit()}},$(".form-signin").length>0&&NSA.signin.init(),$(function(){$("table.sortable thead th").on("click",function(){var t=$("table.sortable thead tr th");t.removeClass("sorted").removeClass("dir-a").removeClass("dir-d");var e=sortTable(t.index($(this)));$(this).addClass("sorted dir-"+e)})});var toggleTips=$(".toggle-help");toggleTips.each(function(){var t,e,a,n;t=$(this),a=$("<span />").attr("class","toggletip"),n=$("<button />").attr("type","button").attr("aria-label","Help").attr("data-toggletip-content",t.html()).text("?").on("click",function(){var e=$(this).data("toggletip-content"),a=$(this).next();window.setTimeout(function(){a.html(function(){return $("<span />").attr("class",function(){return t.html().length>50?"bubble long":"bubble"}).text(e)})},100)}).on("keydown",function(t){27===(t.keyCode||t.which)&&e.html("")}),e=$("<span />").attr("role","status"),a.append(n,e),t.before(a).remove(),$(document).on("click",function(a){t[0]!==$(a.target)&&e.html("")})});var forms=$("#content form");forms.attr("novalidate","novalidate");var NSA=NSA||{};NSA={showPassword:function(){$(".show-password").each(function(t){var e=$(this).find("input:password"),a=$("<label />").prop({for:"show-password-"+t}).html("Show"),n=$("<input />").prop({type:"checkbox",id:"show-password-"+t}).on("change",function(){var t=$(this);e.prop("type",function(){return t.prop("checked")?"text":"password"}),a.html(function(){return t.prop("checked")?"Hide":"Show"}),t.parent().removeClass("type-password"),t.prop("checked")&&t.parent().addClass("type-password")}),i=$("<div />").prop("class","show-password-control").append(n,a);e.after(i)})},backLink:function(){var t=$("<a>").attr({href:"#",class:"link-back"}).text("Back").on("click",function(t){window.history.back(),t.preventDefault()});$(".js-back-link").html(t)}},$("select.select2").length>0&&$("select.select2").select2(),$(".show-password").length>0&&NSA.showPassword(),$(".js-back-link")&&NSA.backLink(),$(".under-construction").on("click",function(t){alert("This functionality is not available yet"),t.preventDefault()}),$(".notification span.icon").length>0&&$(".notification span.icon").on("click",function(){$(this).parent().hide()}),$("article.organisation-services").length>0&&($(".information").on("click",function(t){var e=$(this).parent().parent().find(".service-description");t.preventDefault(),e.toggle()}),$(".info-link").on("click",function(t){var e=$(this).parent().next();t.preventDefault(),e.toggle()}));var searchFields=$("form .search-field");if(searchFields.length>0){var loader=$("<span />").addClass("loader spinner-inline"),b1=$("<span />").addClass("ball b-1"),b2=$("<span />").addClass("ball b-2");loader.append(b1).append(b2),searchFields.each(function(){var t=$(this).parent(),e=t.find("button");t.on("submit",function(){e.after(loader).hide()})})}var showHideContent=new GOVUK.ShowHideContent;showHideContent.init(),GOVUK.details.init();